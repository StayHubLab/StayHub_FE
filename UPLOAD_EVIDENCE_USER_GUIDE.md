# Upload Payment Evidence - Quick User Guide ğŸ“¸

## ğŸ¯ What's New

Your payment evidence upload now has **image preview** and **better error handling**!

---

## ğŸ–¼ï¸ New Features

### 1. Picture Card Display
When you select an image, you'll see a **thumbnail preview** immediately:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Táº£i lÃªn chá»©ng tá»« thanh toÃ¡n        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚  [Image]  â”‚  â† Thumbnail shows  â”‚
â”‚   â”‚ Preview   â”‚     your image!     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚   receipt.jpg                       â”‚
â”‚                                     â”‚
â”‚   [XÃ³a]  [Xem]  â† Click to preview â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Full-Size Preview
Click on the thumbnail to view the image in **full size** with zoom controls:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Image Preview                    [âœ•]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚                                         â”‚
â”‚          [Full Size Image]              â”‚
â”‚                                         â”‚
â”‚         ğŸ“¸ Your Receipt                 â”‚
â”‚                                         â”‚
â”‚                                         â”‚
â”‚  [ğŸ”-] [ğŸ”+] [â†»] [â†º] [â†“] 1/1          â”‚
â”‚  Zoom  Zoom Rotate  Download            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ How to Use

### Step-by-Step Upload Process

#### 1. **Open Upload Modal**
- Go to Bills page
- Find the bill you want to pay
- Click **"Táº£i lÃªn chá»©ng tá»«"** button

#### 2. **Select Your Image**
You have 3 ways to add the file:

**Option A: Click to Browse**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ“‚                  â”‚
â”‚  Click to Upload            â”‚
â”‚  Or drag file here          â”‚
â”‚                             â”‚
â”‚  JPG, PNG or PDF, max 5MB   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†‘ Click here
```

**Option B: Drag & Drop**
```
Drag your file from file explorer
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ“‚                  â”‚
â”‚  Drop file here!            â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Option C: Paste from Clipboard**
- Copy image (Ctrl+C or screenshot)
- Paste (Ctrl+V) in the upload area

#### 3. **Preview Your Image** âœ¨ NEW!
After selecting, the image appears as a card:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   [IMAGE]     â”‚  â† Your payment screenshot
â”‚               â”‚
â”‚  File.jpg     â”‚
â”‚  [ğŸ‘ï¸] [ğŸ—‘ï¸]   â”‚  â† Preview or Remove
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Click the eye icon (ğŸ‘ï¸)** to see full-size preview!

#### 4. **Verify and Upload**
- Check the image is correct
- Click **"Táº£i lÃªn"** button
- Wait for success message: âœ… "Táº£i lÃªn chá»©ng tá»« thanh toÃ¡n thÃ nh cÃ´ng!"

---

## âš ï¸ Validation Rules

### File Type
**Accepted:** âœ…
- `.jpg` / `.jpeg` - JPEG images
- `.png` - PNG images  
- `.pdf` - PDF documents

**Rejected:** âŒ
- `.gif`, `.bmp`, `.webp`, `.doc`, `.txt`, etc.

**Error Message:**
```
âŒ Chá»‰ cháº¥p nháº­n file JPG/PNG/PDF!
```

### File Size
**Maximum:** 5 MB (5,120 KB)

**Error Message:**
```
âŒ File pháº£i nhá» hÆ¡n 5MB!
```

### File Selection
**Required:** At least 1 file must be selected

**Error Message:**
```
âŒ Vui lÃ²ng chá»n file chá»©ng tá»« thanh toÃ¡n
```

---

## ğŸ¨ Visual Changes

### Before (Old Version)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“‚ Drop file here          â”‚
â”‚                             â”‚
â”‚  [No preview shown]         â”‚
â”‚                             â”‚
â”‚  [ Táº£i lÃªn ]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### After (New Version) âœ¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chá»©ng tá»« thanh toÃ¡n        â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ [IMAGE] â”‚ â† Preview!     â”‚
â”‚  â”‚         â”‚                â”‚
â”‚  â”‚ Click   â”‚ â† Clickable!   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  receipt.jpg                â”‚
â”‚                             â”‚
â”‚  [ Táº£i lÃªn ]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› Fixed Issues

### âœ… 1. Upload Error (400 Bad Request)
**Before:** Failed with error
```
âŒ POST .../upload-evidence 400 (Bad Request)
```

**Now:** Works correctly!
```
âœ… Táº£i lÃªn chá»©ng tá»« thanh toÃ¡n thÃ nh cÃ´ng!
```

**What was fixed:**
- `billId` is now properly sent to the backend
- FormData is constructed correctly

### âœ… 2. Context Warning
**Before:** Console warning
```
âš ï¸ Warning: [antd: message] Static function can not consume context...
```

**Now:** No warnings!
```
âœ… Clean console, no errors
```

**What was fixed:**
- Using `App.useApp()` hook instead of static `message`

### âœ… 3. No Image Preview
**Before:** 
- Can't see image before upload
- Just file name shown

**Now:**
- âœ… Thumbnail preview
- âœ… Click to view full size
- âœ… Zoom controls
- âœ… Professional UI

---

## ğŸ“± UI Components

### Upload Area (Dragger)
```jsx
<Dragger listType="picture-card" onPreview={handlePreview}>
  ğŸ“‚ Click or drag file here
  JPG, PNG or PDF, max 5MB
</Dragger>
```

**Features:**
- Drag & drop support
- Click to browse
- Visual feedback
- File validation

### Picture Card
```jsx
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   [IMAGE]   â”‚ â† Thumbnail (auto-generated)
â”‚             â”‚
â”‚  File.jpg   â”‚ â† File name
â”‚  [ğŸ‘ï¸] [ğŸ—‘ï¸] â”‚ â† Actions (preview, remove)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Actions:**
- ğŸ‘ï¸ **Preview** - View full-size image
- ğŸ—‘ï¸ **Remove** - Delete and select another

### Preview Modal
```jsx
Full-screen image viewer with:
- ğŸ” Zoom in/out
- â†» Rotate left/right  
- â†“ Download image
- Navigation (if multiple images)
- ESC to close
```

---

## ğŸ’¡ Tips

### For Best Results

1. **Use Clear Images**
   - Take screenshot of payment confirmation
   - Ensure all details are visible (amount, date, transaction ID)
   - Use good lighting for photos

2. **Check Before Upload**
   - Click preview (ğŸ‘ï¸) to verify image quality
   - Make sure bank name and amount are readable
   - Confirm transaction date matches bill

3. **File Size Optimization**
   - If image > 5MB, resize it first
   - Use JPG instead of PNG for smaller size
   - Crop unnecessary parts

4. **Recommended Format**
   - **Best:** JPG (good quality, small size)
   - **Good:** PNG (high quality, larger size)
   - **OK:** PDF (for official receipts)

---

## ğŸ”„ Complete Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                 â”‚
â”‚  1. Go to Bills Page                            â”‚
â”‚     â†“                                           â”‚
â”‚  2. Find "Chá» thanh toÃ¡n" bill                  â”‚
â”‚     â†“                                           â”‚
â”‚  3. Click "Táº£i lÃªn chá»©ng tá»«"                    â”‚
â”‚     â†“                                           â”‚
â”‚  4. Select image (drag/click/paste)             â”‚
â”‚     â†“                                           â”‚
â”‚  5. âœ¨ Preview appears automatically!           â”‚
â”‚     â†“                                           â”‚
â”‚  6. Click ğŸ‘ï¸ to check full-size (optional)      â”‚
â”‚     â†“                                           â”‚
â”‚  7. Click "Táº£i lÃªn" button                      â”‚
â”‚     â†“                                           â”‚
â”‚  8. âœ… Success! Bill status â†’ "Chá» duyá»‡t"       â”‚
â”‚     â†“                                           â”‚
â”‚  9. Wait for landlord approval                  â”‚
â”‚     â†“                                           â”‚
â”‚ 10. Approved â†’ Status: "ÄÃ£ thanh toÃ¡n" ğŸ‰      â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Success Indicators

### Visual Feedback

**Uploading:**
```
[ Táº£i lÃªn... ] âŒ›
```

**Success:**
```
âœ… Táº£i lÃªn chá»©ng tá»« thanh toÃ¡n thÃ nh cÃ´ng!
```

**Error:**
```
âŒ Táº£i lÃªn chá»©ng tá»« tháº¥t báº¡i
```

### Status Changes

**Before Upload:**
```
Status: Chá» thanh toÃ¡n (ğŸŸ¡ Gold)
```

**After Upload:**
```
Status: Chá» duyá»‡t (ğŸ”µ Blue)
```

**After Approval:**
```
Status: ÄÃ£ thanh toÃ¡n (ğŸŸ¢ Green)
```

**If Rejected:**
```
Status: Bá»‹ tá»« chá»‘i (ğŸ”´ Red)
â†’ Can re-upload with corrected evidence
```

---

## ğŸ“ Troubleshooting

### Problem: Can't see preview
**Solution:** 
- Make sure file is JPG/PNG (not PDF)
- Refresh page and try again
- Clear browser cache

### Problem: Upload button disabled
**Solution:**
- Make sure you selected a file
- Check file size < 5MB
- Check file type is JPG/PNG/PDF

### Problem: Image too large
**Solution:**
- Resize image using built-in Windows Photo app
- Or use online tools: TinyPNG, Compressor.io
- Target size: 1-2MB is ideal

### Problem: Preview not working
**Solution:**
- Check browser supports FileReader API
- Update browser to latest version
- Try different browser (Chrome/Edge recommended)

---

## ğŸ“ Technical Details

### How Preview Works

1. **File Selection**
   ```
   User selects file â†’ beforeUpload() triggered
   ```

2. **Validation**
   ```
   Check type (JPG/PNG/PDF) â†’ Check size (< 5MB)
   ```

3. **Preview Generation** (for images only)
   ```
   FileReader â†’ readAsDataURL() â†’ Base64 string
   ```

4. **Display**
   ```
   Base64 â†’ thumbnail + full preview capability
   ```

5. **Upload**
   ```
   User clicks "Táº£i lÃªn" â†’ FormData â†’ Backend
   ```

### Data Flow
```
Component                  API                  Backend
    â”‚                      â”‚                      â”‚
    â”‚â”€â”€â”€ Select File â”€â”€â”€â”€â”€â†’â”‚                      â”‚
    â”‚                      â”‚                      â”‚
    â”‚â†â”€â”€ Preview Image â”€â”€â”€â”€â”‚                      â”‚
    â”‚                      â”‚                      â”‚
    â”‚â”€â”€â”€ Click Upload â”€â”€â”€â”€â†’â”‚                      â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚â”€â”€â”€â”€ POST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚
    â”‚                      â”‚      FormData        â”‚
    â”‚                      â”‚      - billId        â”‚
    â”‚                      â”‚      - file          â”‚
    â”‚                      â”‚                      â”‚
    â”‚                      â”‚â†â”€â”€â”€â”€ Response â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚                      â”‚      { success }     â”‚
    â”‚                      â”‚                      â”‚
    â”‚â†â”€â”€ Success Msg â”€â”€â”€â”€â”€â”€â”‚                      â”‚
    â”‚                      â”‚                      â”‚
```

---

**All features working perfectly! ğŸš€**

**Next Steps:**
1. Test the upload with real payment screenshot
2. Verify preview shows correctly
3. Submit to landlord for approval
4. Receive payment confirmation!

---

*Need help? Check the main documentation or contact support.*
